<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Cinema Booking</title>
    <link rel="stylesheet" href="admin.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="admin-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <i class="fas fa-film"></i>
                <h2>Admin Panel</h2>
            </div>
            <nav class="sidebar-nav">
                <a href="#dashboard" class="nav-item active" data-section="dashboard">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Dashboard</span>
                </a>
                <a href="#movies" class="nav-item" data-section="movies">
                    <i class="fas fa-film"></i>
                    <span>Quản lý Phim</span>
                </a>
                <a href="#categories" class="nav-item" data-section="categories">
                    <i class="fas fa-tags"></i>
                    <span>Thể loại</span>
                </a>
                <a href="#users" class="nav-item" data-section="users">
                    <i class="fas fa-users"></i>
                    <span>Người dùng</span>
                </a>
                <a href="#showtimes" class="nav-item" data-section="showtimes">
                    <i class="fas fa-clock"></i>
                    <span>Suất chiếu</span>
                </a>
                <a href="#bookings" class="nav-item" data-section="bookings">
                    <i class="fas fa-ticket-alt"></i>
                    <span>Đặt vé</span>
                </a>
                <a href="#statistics" class="nav-item" data-section="statistics">
                    <i class="fas fa-chart-bar"></i>
                    <span>Thống kê</span>
                </a>
                <a href="#settings" class="nav-item" data-section="settings">
                    <i class="fas fa-cog"></i>
                    <span>Cài đặt</span>
                </a>
            </nav>
            <div class="sidebar-footer">
                <button class="btn-logout" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Đăng xuất</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Top Header -->
            <header class="top-header">
                <div class="header-left">
                    <button class="sidebar-toggle" onclick="toggleSidebar()">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h1 id="pageTitle">Dashboard</h1>
                </div>
                <div class="header-right">
                    <div class="admin-info">
                        <span id="adminName">Admin</span>
                        <span class="role-badge">Super Admin</span>
                    </div>
                    <div class="notifications">
                        <i class="fas fa-bell"></i>
                        <span class="notification-count">3</span>
                    </div>
                </div>
            </header>

            <!-- Content Sections -->
            <div class="content-wrapper">
                <!-- Dashboard Section -->
                <section id="dashboard" class="content-section active">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-film"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="totalMovies">0</h3>
                                <p>Tổng số phim</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="totalUsers">0</h3>
                                <p>Người dùng</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-ticket-alt"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="totalBookings">0</h3>
                                <p>Đặt vé hôm nay</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-dollar-sign"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="totalRevenue">0 VNĐ</h3>
                                <p>Doanh thu hôm nay</p>
                            </div>
                        </div>
                    </div>

                    <div class="charts-grid">
                        <div class="chart-card">
                            <h3>Phim Hot Nhất</h3>
                            <canvas id="popularMoviesChart"></canvas>
                        </div>
                        <div class="chart-card">
                            <h3>Doanh Thu Theo Tháng</h3>
                            <canvas id="revenueChart"></canvas>
                        </div>
                    </div>

                    <div class="recent-activity">
                        <h3>Hoạt Động Gần Đây</h3>
                        <div class="activity-list" id="activityList">
                            <!-- Activity items will be loaded here -->
                        </div>
                    </div>
                </section>

                <!-- Movies Management Section -->
                <section id="movies" class="content-section">
                    <div class="section-header">
                        <h2>Quản lý Phim</h2>
                        <button class="btn-primary" onclick="showAddMovieModal()">
                            <i class="fas fa-plus"></i> Thêm Phim Mới
                        </button>
                    </div>

                    <div class="filters">
                        <input type="text" id="movieSearch" placeholder="Tìm kiếm phim..." class="search-input">
                        <select id="categoryFilter" class="filter-select">
                            <option value="">Tất cả thể loại</option>
                        </select>
                        <select id="statusFilter" class="filter-select">
                            <option value="">Tất cả trạng thái</option>
                            <option value="active">Đang chiếu</option>
                            <option value="inactive">Tạm dừng</option>
                        </select>
                    </div>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Ảnh</th>
                                    <th>Tên phim</th>
                                    <th>Thể loại</th>
                                    <th>Thời lượng</th>
                                    <th>Đánh giá</th>
                                    <th>Trạng thái</th>
                                    <th>Thao tác</th>
                                </tr>
                            </thead>
                            <tbody id="moviesTableBody">
                                <!-- Movies will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Categories Management Section -->
                <section id="categories" class="content-section">
                    <div class="section-header">
                        <h2>Quản lý Thể loại</h2>
                        <button class="btn-primary" onclick="showAddCategoryModal()">
                            <i class="fas fa-plus"></i> Thêm Thể loại
                        </button>
                    </div>

                    <div class="categories-grid" id="categoriesGrid">
                        <!-- Categories will be loaded here -->
                    </div>
                </section>

                <!-- Users Management Section -->
                <section id="users" class="content-section">
                    <div class="section-header">
                        <h2>Quản lý Người dùng</h2>
                        <button class="btn-primary" onclick="showAddUserModal()">
                            <i class="fas fa-plus"></i> Thêm Người dùng
                        </button>
                    </div>

                    <div class="filters">
                        <input type="text" id="userSearch" placeholder="Tìm kiếm người dùng..." class="search-input">
                        <select id="roleFilter" class="filter-select">
                            <option value="">Tất cả vai trò</option>
                            <option value="user">User</option>
                            <option value="moderator">Moderator</option>
                            <option value="admin">Admin</option>
                        </select>
                        <select id="statusFilter" class="filter-select">
                            <option value="">Tất cả trạng thái</option>
                            <option value="active">Hoạt động</option>
                            <option value="blocked">Bị chặn</option>
                        </select>
                    </div>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Avatar</th>
                                    <th>Tên</th>
                                    <th>Email</th>
                                    <th>Vai trò</th>
                                    <th>Trạng thái</th>
                                    <th>Ngày tạo</th>
                                    <th>Thao tác</th>
                                </tr>
                            </thead>
                            <tbody id="usersTableBody">
                                <!-- Users will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Showtimes Management Section -->
                <section id="showtimes" class="content-section">
                    <div class="section-header">
                        <h2>Quản lý Suất chiếu</h2>
                        <button class="btn-primary" onclick="showAddShowtimeModal()">
                            <i class="fas fa-plus"></i> Thêm Suất chiếu
                        </button>
                    </div>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Phim</th>
                                    <th>Thời gian</th>
                                    <th>Ngày</th>
                                    <th>Giá vé</th>
                                    <th>Ghế còn lại</th>
                                    <th>Trạng thái</th>
                                    <th>Thao tác</th>
                                </tr>
                            </thead>
                            <tbody id="showtimesTableBody">
                                <!-- Showtimes will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Bookings Management Section -->
                <section id="bookings" class="content-section">
                    <div class="section-header">
                        <h2>Quản lý Đặt vé</h2>
                    </div>

                    <div class="filters">
                        <input type="text" id="bookingSearch" placeholder="Tìm kiếm đặt vé..." class="search-input">
                        <select id="bookingStatusFilter" class="filter-select">
                            <option value="">Tất cả trạng thái</option>
                            <option value="confirmed">Đã xác nhận</option>
                            <option value="cancelled">Đã hủy</option>
                            <option value="pending">Chờ xác nhận</option>
                        </select>
                        <input type="date" id="dateFilter" class="filter-date">
                    </div>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Mã vé</th>
                                    <th>Người đặt</th>
                                    <th>Phim</th>
                                    <th>Suất chiếu</th>
                                    <th>Ghế</th>
                                    <th>Tổng tiền</th>
                                    <th>Trạng thái</th>
                                    <th>Thao tác</th>
                                </tr>
                            </thead>
                            <tbody id="bookingsTableBody">
                                <!-- Bookings will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Statistics Section -->
                <section id="statistics" class="content-section">
                    <div class="section-header">
                        <h2>Thống kê Chi tiết</h2>
                        <div class="date-range">
                            <input type="date" id="startDate" class="date-input">
                            <span>đến</span>
                            <input type="date" id="endDate" class="date-input">
                            <button class="btn-secondary" onclick="updateStatistics()">Cập nhật</button>
                        </div>
                    </div>

                    <div class="stats-detail-grid">
                        <div class="stat-detail-card">
                            <h3>Thống kê Phim</h3>
                            <canvas id="movieStatsChart"></canvas>
                        </div>
                        <div class="stat-detail-card">
                            <h3>Thống kê Người dùng</h3>
                            <canvas id="userStatsChart"></canvas>
                        </div>
                        <div class="stat-detail-card">
                            <h3>Thống kê Doanh thu</h3>
                            <canvas id="revenueStatsChart"></canvas>
                        </div>
                        <div class="stat-detail-card">
                            <h3>Top Phim Xem Nhiều</h3>
                            <div class="top-movies-list" id="topMoviesList">
                                <!-- Top movies will be loaded here -->
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Settings Section -->
                <section id="settings" class="content-section">
                    <div class="section-header">
                        <h2>Cài đặt Hệ thống</h2>
                    </div>

                    <div class="settings-grid">
                        <div class="setting-card">
                            <h3>Cài đặt Chung</h3>
                            <form id="generalSettingsForm">
                                <div class="form-group">
                                    <label>Tên hệ thống</label>
                                    <input type="text" id="systemName" value="Cinema Booking System">
                                </div>
                                <div class="form-group">
                                    <label>Email liên hệ</label>
                                    <input type="email" id="contactEmail" value="admin@cinemabooking.com">
                                </div>
                                <div class="form-group">
                                    <label>Số điện thoại</label>
                                    <input type="tel" id="contactPhone" value="+84 123 456 789">
                                </div>
                                <button type="submit" class="btn-primary">Lưu cài đặt</button>
                            </form>
                        </div>

                        <div class="setting-card">
                            <h3>Cài đặt Bảo mật</h3>
                            <form id="securitySettingsForm">
                                <div class="form-group">
                                    <label>Thời gian session (phút)</label>
                                    <input type="number" id="sessionTimeout" value="30">
                                </div>
                                <div class="form-group">
                                    <label>Số lần đăng nhập sai tối đa</label>
                                    <input type="number" id="maxLoginAttempts" value="5">
                                </div>
                                <div class="form-group">
                                    <label>Kích hoạt 2FA</label>
                                    <input type="checkbox" id="enable2FA">
                                </div>
                                <button type="submit" class="btn-primary">Lưu cài đặt</button>
                            </form>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- Modals -->
    <!-- Add/Edit Movie Modal -->
    <div class="modal" id="movieModal">
        <div class="modal-content large">
            <div class="modal-header">
                <h2 id="movieModalTitle">Thêm Phim Mới</h2>
                <button class="close-modal" onclick="closeModal('movieModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="movieForm" class="modal-form" enctype="multipart/form-data">
                <div class="form-row">
                    <div class="form-group">
                        <label>Tên phim *</label>
                        <input type="text" id="movieTitle" name="movieTitle" required>
                    </div>
                    <div class="form-group">
                        <label>Thể loại *</label>
                        <select id="movieCategory" name="movieCategory" required>
                            <!-- Categories will be loaded here -->
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Thời lượng (phút) *</label>
                        <input type="number" id="movieDuration" name="movieDuration" required>
                    </div>
                    <div class="form-group">
                        <label>Đánh giá</label>
                        <input type="text" id="movieRating" name="movieRating" placeholder="8.5/10">
                    </div>
                </div>
                <div class="form-group">
                    <label>Mô tả</label>
                    <textarea id="movieDescription" name="movieDescription" rows="4"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Trailer URL</label>
                        <input type="url" id="movieTrailer" name="movieTrailer">
                    </div>
                    <div class="form-group">
                        <label>Phụ đề</label>
                        <input type="text" id="movieSubtitles" name="movieSubtitles" placeholder="Tiếng Việt, English">
                    </div>
                </div>
                <div class="form-group">
                    <label>Ảnh bìa</label>
                    <input type="file" id="moviePoster" name="moviePoster" accept="image/*">
                    <div class="image-preview" id="posterPreview"></div>
                </div>
                <div class="form-group">
                    <label>File video</label>
                    <input type="file" id="movieVideo" name="movieVideo" accept="video/*">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="closeModal('movieModal')">Hủy</button>
                    <button type="submit" class="btn-primary">Lưu</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add/Edit Category Modal -->
    <div class="modal" id="categoryModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="categoryModalTitle">Thêm Thể loại</h2>
                <button class="close-modal" onclick="closeModal('categoryModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="categoryForm" class="modal-form">
                <div class="form-group">
                    <label>Tên thể loại *</label>
                    <input type="text" id="categoryName" name="categoryName" required>
                </div>
                <div class="form-group">
                    <label>Mô tả</label>
                    <textarea id="categoryDescription" name="categoryDescription" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>Màu sắc</label>
                    <input type="color" id="categoryColor" name="categoryColor" value="#667eea">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="closeModal('categoryModal')">Hủy</button>
                    <button type="submit" class="btn-primary">Lưu</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add/Edit User Modal -->
    <div class="modal" id="userModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="userModalTitle">Thêm Người dùng</h2>
                <button class="close-modal" onclick="closeModal('userModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="userForm" class="modal-form">
                <div class="form-row">
                    <div class="form-group">
                        <label>Họ tên *</label>
                        <input type="text" id="userName" name="userName" required>
                    </div>
                    <div class="form-group">
                        <label>Email *</label>
                        <input type="email" id="userEmail" name="userEmail" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Số điện thoại</label>
                        <input type="tel" id="userPhone" name="userPhone">
                    </div>
                    <div class="form-group">
                        <label>Vai trò *</label>
                        <select id="userRole" name="userRole" required>
                            <option value="user">User</option>
                            <option value="moderator">Moderator</option>
                            <option value="admin">Admin</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Mật khẩu *</label>
                    <input type="password" id="userPassword" name="userPassword" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="closeModal('userModal')">Hủy</button>
                    <button type="submit" class="btn-primary">Lưu</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add/Edit Showtime Modal -->
    <div class="modal" id="showtimeModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="showtimeModalTitle">Thêm Suất chiếu</h2>
                <button class="close-modal" onclick="closeModal('showtimeModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="showtimeForm" class="modal-form">
                <div class="form-group">
                    <label>Phim *</label>
                    <select id="showtimeMovie" name="showtimeMovie" required>
                        <!-- Movies will be loaded here -->
                    </select>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Thời gian *</label>
                        <input type="time" id="showtimeTime" name="showtimeTime" required>
                    </div>
                    <div class="form-group">
                        <label>Ngày *</label>
                        <input type="date" id="showtimeDate" name="showtimeDate" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Giá vé (VNĐ) *</label>
                        <input type="number" id="showtimePrice" name="showtimePrice" required>
                    </div>
                    <div class="form-group">
                        <label>Số ghế tối đa</label>
                        <input type="number" id="showtimeMaxSeats" name="showtimeMaxSeats" value="80">
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="closeModal('showtimeModal')">Hủy</button>
                    <button type="submit" class="btn-primary">Lưu</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div class="modal" id="confirmModal">
        <div class="modal-content small">
            <div class="modal-header">
                <h2>Xác nhận</h2>
                <button class="close-modal" onclick="closeModal('confirmModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <p id="confirmMessage">Bạn có chắc chắn muốn thực hiện hành động này?</p>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeModal('confirmModal')">Hủy</button>
                <button class="btn-danger" id="confirmAction">Xác nhận</button>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <span id="notificationMessage"></span>
        <button id="closeNotification">
            <i class="fas fa-times"></i>
        </button>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="admin.js"></script>
</body>
</html>
